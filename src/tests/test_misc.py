from surface.communication.core import Worker


def test_dynamic_encoding():
    """
    Validating encoding logic against the last example documented here:
     https://solidity.readthedocs.io/en/develop/abi-spec.html

    :return:
    """
    f_def = 'f(uint256,uint32[],bytes10,bytes)'
    args = [0x123, [0x456, 0x789], b'1234567890', b'Hello, world!']
    function_hash = Worker.encode_call(f_def, args)
    ref = (
        '0x8be65246'
        '0000000000000000000000000000000000000000000000000000000000000123'
        '0000000000000000000000000000000000000000000000000000000000000080'
        '3132333435363738393000000000000000000000000000000000000000000000'
        '00000000000000000000000000000000000000000000000000000000000000e0'
        '0000000000000000000000000000000000000000000000000000000000000002'
        '0000000000000000000000000000000000000000000000000000000000000456'
        '0000000000000000000000000000000000000000000000000000000000000789'
        '000000000000000000000000000000000000000000000000000000000000000d'
        '48656c6c6f2c20776f726c642100000000000000000000000000000000000000'
    )
    assert True
    assert function_hash == ref
