from surface.communication import core
import pytest
core_socket = core.IPC(5552)


#6080604052600436106100ae5763ffffffff7c010000000000000000000000000000000000000000000000000000000060003504166303988f8481146100b357806310f11e84146101165780632aaf281b146102095780633b8332451461028457806357f5fc28146102b4578063850d86191461034a578063a06a58561461035d578063b24fd5c51461037b578063d10e1e69146103ac578063daefe7381461040c578063dd20866e1461045d575b600080fd5b3480156100bf57600080fd5b506100cb60043561051a565b60408051600160a060020a0390991689526020890197909752878701959095526060870193909352608086019190915260a085015260c084015260e083015251908190036101000190f35b34801561012257600080fd5b5061012b610578565b60405180806020018060200180602001848103845287818151815260200191508051906020019060200280838360005b8381101561017357818101518382015260200161015b565b50505050905001848103835286818151815260200191508051906020019060200280838360005b838110156101b257818101518382015260200161019a565b50505050905001848103825285818151815260200191508051906020019060200280838360005b838110156101f15781810151838201526020016101d9565b50505050905001965050505050505060405180910390f35b60408051602060046024803582810135601f810185900485028601850190965285855261026095833563ffffffff1695369560449491939091019190819084018382808284375094975061070e9650505050505050565b6040518082600181111561027057fe5b60ff16815260200191505060405180910390f35b34801561029057600080fd5b506102a263ffffffff60043516610ac2565b60408051918252519081900360200190f35b3480156102c057600080fd5b506102d563ffffffff60043516602435610af3565b6040805160208082528351818301528351919283929083019185019080838360005b8381101561030f5781810151838201526020016102f7565b50505050905090810190601f16801561033c5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b61035b63ffffffff60043516610bc3565b005b34801561036957600080fd5b50610260600435602435604435610cae565b34801561038757600080fd5b50610390610faf565b60408051600160a060020a039092168252519081900360200190f35b3480156103b857600080fd5b5060408051602060046024803582810135848102808701860190975280865261026096843563ffffffff1696369660449591949091019291829185019084908082843750949750610fbe9650505050505050565b34801561041857600080fd5b5061042a63ffffffff60043516611233565b604080519687526020870195909552858501939093526060850191909152608084015260a0830152519081900360c00190f35b34801561046957600080fd5b506040805160206004602480358281013584810280870186019097528086526104bf96843563ffffffff169636966044959194909101929182918501908490808284375094975050933594506113519350505050565b6040518083815260200180602001828103825283818151815260200191508051906020019060200280838360005b838110156105055781810151838201526020016104ed565b50505050905001935050505060405180910390f35b600180548290811061052857fe5b60009182526020909120600b909102018054600182015460038301546004840154600585015460068601546007870154600a90970154600160a060020a0390961697509395929491939092909188565b60608060608060608060006001805490506040519080825280602002602001820160405280156105b2578160200160208202803883390190505b5060015460408051828152602080840282010190915291955080156105e1578160200160208202803883390190505b506001546040805182815260208084028201019091529194508015610610578160200160208202803883390190505b509150600090505b60015481101561070157600180548290811061063057fe5b90600052602060002090600b0201600a0154848281518110151561065057fe5b6020908102909101015260018054600091908390811061066c57fe5b600091825260208083203384526002600b90930201919091019052604090205411156106ad57600183828151811015156106a257fe5b602090810290910101525b60018054339190839081106106be57fe5b60009182526020909120600b9091020154600160a060020a031614156106f957600182828151811015156106ee57fe5b602090810290910101525b600101610618565b5091959094509092509050565b600080348110610768576040805160e560020a62461bcd02815260206004820152601f60248201527f4465706f7369742076616c7565206d75737420626520706f7369746976652e00604482015290519081900360640190fd5b6001805463ffffffff861690811061077c57fe5b90600052602060002090600b0201600a015460001415156107e7576040805160e560020a62461bcd02815260206004820152601b60248201527f496c6c6567616c20737461746520666f72206465706f736974732e0000000000604482015290519081900360640190fd5b6001805463ffffffff86169081106107fb57fe5b90600052602060002090600b0201905080600601543481151561081a57fe5b0615610896576040805160e560020a62461bcd02815260206004820152602f60248201527f4465706f7369742076616c7565206d7573742062652061206d756c7469706c6560448201527f206f6620636c61696d2076616c75650000000000000000000000000000000000606482015290519081900360840190fd5b33600090815260028201602052604090205415610923576040805160e560020a62461bcd02815260206004820152602a60248201527f43616e6e6f74206465706f73697420747769636520776974682074686520736160448201527f6d65206164647265737300000000000000000000000000000000000000000000606482015290519081900360840190fd5b600381018054349081019091553360009081526002830160205260409020556004810154600882018054859290811061095857fe5b906000526020600020019080519060200190610975929190611477565b506004810180546001908101909155604080513460208083018290529282018490526080808352875190830152865163ffffffff89169433947fce7036acc3606aaa1ec3a2e7b4d13b3f4da34ee1eac298fc47524074de74a3bf948a949390918291606083019160a08401919088019080838360005b83811015610a035781810151838201526020016109eb565b50505050905090810190601f168015610a305780820380516001836020036101000a031916815260200191505b50928303905250600881527f616c6c20676f6f6400000000000000000000000000000000000000000000000060208201526040805191829003019350915050a36007810154600482015410610ab8576001600a82015560405163ffffffff8516907fa98c11bc69afe22b520fe800f82e421f9594d4f06259a7600711b75af05a43b990600090a25b5060009392505050565b600060018263ffffffff16815481101515610ad957fe5b600091825260209091206008600b90920201015492915050565b606060018363ffffffff16815481101515610b0a57fe5b90600052602060002090600b020160080182815481101515610b2857fe5b600091825260209182902001805460408051601f6002600019610100600187161502019094169390930492830185900485028101850190915281815292830182828015610bb65780601f10610b8b57610100808354040283529160200191610bb6565b820191906000526020600020905b815481529060010190602001808311610b9957829003601f168201915b5050505050905092915050565b600060608060018463ffffffff16815481101515610bdd57fe5b6000918252602090912060408051818152606081018252600b909302909101945081602001602082028038833950506040805160018082528183019092529294509050602080830190803883390190505090507f72616e6428290000000000000000000000000000000000000000000000000000816000815181101515610c6057fe5b60209081029091018101919091526040805160018152905163ffffffff8716927fb37f76c8ba24e6a6d20d203681329001f2cacd9ab37c09d8b2aee57b8a31b874928290030190a250505050565b600180546000918190610cc3908281016114f5565b503360018263ffffffff16815481101515610cda57fe5b90600052602060002090600b020160000160006101000a815481600160a060020a030219169083600160a060020a031602179055508460018263ffffffff16815481101515610d2557fe5b90600052602060002090600b02016001018160001916905550600060018263ffffffff16815481101515610d5557fe5b90600052602060002090600b020160030181905550600060018263ffffffff16815481101515610d8157fe5b90600052602060002090600b0201600401819055504260018263ffffffff16815481101515610dac57fe5b90600052602060002090600b0201600501819055508360018263ffffffff16815481101515610dd757fe5b90600052602060002090600b0201600601819055508260018263ffffffff16815481101515610e0257fe5b90600052602060002090600b02016007018190555082604051908082528060200260200182016040528015610e4b57816020015b6060815260200190600190039081610e365790505b506001805463ffffffff8416908110610e6057fe5b90600052602060002090600b02016008019080519060200190610e84929190611526565b5082604051908082528060200260200182016040528015610eaf578160200160208202803883390190505b506001805463ffffffff8416908110610ec457fe5b90600052602060002090600b02016009019080519060200190610ee892919061157f565b50600060018263ffffffff16815481101515610f0057fe5b6000918252602091829020600a600b90920201019190915560408051428152918201879052818101869052606082018590526001608083015260c060a083018190526008908301527f616c6c20676f6f6400000000000000000000000000000000000000000000000060e08301525163ffffffff83169133917f8c2ac5e09d37c38a96fb20791b6ed6f2ccaaaf26c4115680b9257504d32bcdc3918190036101000190a3506000949350505050565b600054600160a060020a031681565b60008060018463ffffffff16815481101515610fd657fe5b90600052602060002090600b0201600a01546001141515611041576040805160e560020a62461bcd02815260206004820152601560248201527f4465616c206973206e6f742065786563757465642e0000000000000000000000604482015290519081900360640190fd5b8260018563ffffffff1681548110151561105757fe5b90600052602060002090600b0201600901908051906020019061107b92919061157f565b50600090505b6001805463ffffffff861690811061109557fe5b90600052602060002090600b02016009018054905081101561115a576001805463ffffffff86169081106110c557fe5b90600052602060002090600b0201600901818154811015156110e357fe5b60009182526020909120015460018054600160a060020a03909216916108fc919063ffffffff881690811061111457fe5b90600052602060002090600b0201600601549081150290604051600060405180830381858888f19350505050158015611151573d6000803e3d6000fd5b50600101611081565b6001805463ffffffff8616917f61347ea145bc2f7f5814e4a2b5e70991c5c42870bfd4df70ab8ea10c41cfa89d918390811061119257fe5b90600052602060002090600b02016006015460018763ffffffff168154811015156111b957fe5b60009182526020918290206009600b9092020101546040805193845263ffffffff909116918301919091526001828201526080606083018190526008908301527f616c6c20676f6f6400000000000000000000000000000000000000000000000060a0830152519081900360c00190a25060009392505050565b60008060008060008060008060008060008060018d63ffffffff1681548110151561125a57fe5b90600052602060002090600b020160010154955060018d63ffffffff1681548110151561128357fe5b90600052602060002090600b020160070154945060018d63ffffffff168154811015156112ac57fe5b90600052602060002090600b020160060154935060018d63ffffffff168154811015156112d557fe5b90600052602060002090600b020160040154925060018d63ffffffff168154811015156112fe57fe5b90600052602060002090600b020160030154915060018d63ffffffff1681548110151561132757fe5b600091825260209091206009600b909202010154959d949c50929a50909850965091945092505050565b815160009060609082805b600083111561146357604080516001880181529051908190036020019020839081151561138557fe5b069150866001840381518110151561139957fe5b90602001906020020151600160a060020a031687838151811015156113ba57fe5b60209081029091010151600160a060020a0316146114575786600184038151811015156113e357fe5b90602001906020020151905086828151811015156113fd57fe5b90602001906020020151876001850381518110151561141857fe5b600160a060020a039092166020928302909101909101528651819088908490811061143f57fe5b600160a060020a039092166020928302909101909101525b6000199092019161135c565b50505063ffffffff94909416949293505050565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106114b857805160ff19168380011785556114e5565b828001600101855582156114e5579182015b828111156114e55782518255916020019190600101906114ca565b506114f19291506115ed565b5090565b81548183558181111561152157600b0281600b028360005260206000209182019101611521919061160a565b505050565b828054828255906000526020600020908101928215611573579160200282015b828111156115735782518051611563918491602090910190611477565b5091602001919060010190611546565b506114f192915061168a565b8280548282559060005260206000209081019282156115e1579160200282015b828111156115e1578251825473ffffffffffffffffffffffffffffffffffffffff1916600160a060020a0390911617825560209092019160019091019061159f565b506114f19291506116ad565b61160791905b808211156114f157600081556001016115f3565b90565b61160791905b808211156114f157805473ffffffffffffffffffffffffffffffffffffffff19168155600060018201819055600382018190556004820181905560058201819055600682018190556007820181905561166c60088301826116de565b61167a6009830160006116ff565b506000600a820155600b01611610565b61160791905b808211156114f15760006116a4828261171d565b50600101611690565b61160791905b808211156114f157805473ffffffffffffffffffffffffffffffffffffffff191681556001016116b3565b50805460008255906000526020600020908101906116fc919061168a565b50565b50805460008255906000526020600020908101906116fc91906115ed565b50805460018160011615610100020316600290046000825580601f1061174357506116fc565b601f0160209004906000526020600020908101906116fc91906115ed5600a165627a7a7230582051910926ea55049d447d261d007a8b619986a8d7905958f802cb0688c27259bd0029
#"f9015c80f90158b8aa3031646436386239366330613337303466303036653431393432356163613962636464633537303465333539356332393735303031343733336266373536653936366465626335393561343466613666383361343065363232393263316262616636313061373933356538613034623333373064363437323837333764636132346463653866323064393935323339643836616630333463636633323631663937623831333762393732b8aa3031646436386239366330613337303466303036653431393432356163613962636464633537303465333539356332393735303031343733336266373536653936366465626335393561343466613666383361343065363232393263316262616636313061373933356538613034623333373064363437323837333764636132346463653866323064393935323339643836616630333463636633323631663937623831333762393732"
# callable = "mixAddresses(uint,address[],uint)"
# callback = "distribute(uint32,address[])"

@pytest.mark.skip(reason="Core needs to be alive for this")
@pytest.mark.second
def test_exec_evm():
    bytecode = "6080604052600436106100c5576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806303988f84146100ca57806310f11e84146101705780632aaf281b1461026c5780633b833245146102fa57806357f5fc28146103415780636db0c8f0146103f7578063850d86191461049357806385e3c463146104b9578063a06a585614610529578063b24fd5c514610590578063daefe738146105e7578063dd20866e14610659578063ed0b494c14610735575b600080fd5b3480156100d657600080fd5b506100f56004803603810190808035906020019092919050505061080a565b604051808973ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200188600019166000191681526020018781526020018681526020018581526020018481526020018381526020018281526020019850505050505050505060405180910390f35b34801561017c57600080fd5b50610185610881565b60405180806020018060200180602001848103845287818151815260200191508051906020019060200280838360005b838110156101d05780820151818401526020810190506101b5565b50505050905001848103835286818151815260200191508051906020019060200280838360005b838110156102125780820151818401526020810190506101f7565b50505050905001848103825285818151815260200191508051906020019060200280838360005b83811015610254578082015181840152602081019050610239565b50505050905001965050505050505060405180910390f35b6102d6600480360381019080803563ffffffff169060200190929190803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509192919290505050610ab7565b604051808260018111156102e657fe5b60ff16815260200191505060405180910390f35b34801561030657600080fd5b5061032b600480360381019080803563ffffffff169060200190929190505050610f82565b6040518082815260200191505060405180910390f35b34801561034d57600080fd5b5061037c600480360381019080803563ffffffff16906020019092919080359060200190929190505050610fb5565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156103bc5780820151818401526020810190506103a1565b50505050905090810190601f1680156103e95780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34801561040357600080fd5b5061047d6004803603810190808035906020019082018035906020019080806020026020016040519081016040528093929190818152602001838360200280828437820191505050505050919291929080356000191690602001909291908035906020019092919080359060200190929190505050611095565b6040518082815260200191505060405180910390f35b6104b7600480360381019080803563ffffffff169060200190929190505050611108565b005b3480156104c557600080fd5b50610527600480360381019080803590602001909291908035906020019082018035906020019080806020026020016040519081016040528093929190818152602001838360200280828437820191505050505050919291929050505061122c565b005b34801561053557600080fd5b5061056c60048036038101908080356000191690602001909291908035906020019092919080359060200190929190505050611230565b6040518082600181111561057c57fe5b60ff16815260200191505060405180910390f35b34801561059c57600080fd5b506105a5611589565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b3480156105f357600080fd5b50610618600480360381019080803563ffffffff1690602001909291905050506115ae565b604051808760001916600019168152602001868152602001858152602001848152602001838152602001828152602001965050505050505060405180910390f35b34801561066557600080fd5b506106d7600480360381019080803563ffffffff16906020019092919080359060200190820180359060200190808060200260200160405190810160405280939291908181526020018383602002808284378201915050505050509192919290803590602001909291905050506116da565b6040518083815260200180602001828103825283818151815260200191508051906020019060200280838360005b83811015610720578082015181840152602081019050610705565b50505050905001935050505060405180910390f35b34801561074157600080fd5b506107f46004803603810190808035906020019082018035906020019080806020026020016040519081016040528093929190818152602001838360200280828437820191505050505050919291929080356000191690602001909291908035906020019092919080359060200190820180359060200190808060200260200160405190810160405280939291908181526020018383602002808284378201915050505050509192919290505050611877565b6040518082815260200191505060405180910390f35b60018181548110151561081957fe5b90600052602060002090600b02016000915090508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169080600101549080600301549080600401549080600501549080600601549080600701549080600a0154905088565b60608060608060608060006001805490506040519080825280602002602001820160405280156108c05781602001602082028038833980820191505090505b5093506001805490506040519080825280602002602001820160405280156108f75781602001602082028038833980820191505090505b50925060018054905060405190808252806020026020018201604052801561092e5781602001602082028038833980820191505090505b509150600090505b600180549050811015610aa55760018181548110151561095257fe5b90600052602060002090600b0201600a0154848281518110151561097257fe5b9060200190602002018181525050600060018281548110151561099157fe5b90600052602060002090600b020160020160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020541115610a0557600183828151811015156109f657fe5b90602001906020020181815250505b3373ffffffffffffffffffffffffffffffffffffffff16600182815481101515610a2b57fe5b90600052602060002090600b020160000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161415610a985760018282815181101515610a8957fe5b90602001906020020181815250505b8080600101915050610936565b83838396509650965050505050909192565b600080600034111515610b32576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601f8152602001807f4465706f7369742076616c7565206d75737420626520706f7369746976652e0081525060200191505060405180910390fd5b600060018563ffffffff16815481101515610b4957fe5b90600052602060002090600b0201600a0154141515610bd0576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601b8152602001807f496c6c6567616c20737461746520666f72206465706f736974732e000000000081525060200191505060405180910390fd5b60018463ffffffff16815481101515610be557fe5b90600052602060002090600b020190506000816006015434811515610c0657fe5b06141515610ca2576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602f8152602001807f4465706f7369742076616c7565206d7573742062652061206d756c7469706c6581526020017f206f6620636c61696d2076616c7565000000000000000000000000000000000081525060400191505060405180910390fd5b60008160020160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054141515610d81576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602a8152602001807f43616e6e6f74206465706f73697420747769636520776974682074686520736181526020017f6d6520616464726573730000000000000000000000000000000000000000000081525060400191505060405180910390fd5b348160030160008282540192505081905550348160020160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208190555082816008018260040154815481101515610def57fe5b906000526020600020019080519060200190610e0c9291906119bf565b50600181600401600082825401925050819055508363ffffffff163373ffffffffffffffffffffffffffffffffffffffff167fce7036acc3606aaa1ec3a2e7b4d13b3f4da34ee1eac298fc47524074de74a3bf8534600160405180806020018481526020018315151515815260200180602001838103835286818151815260200191508051906020019080838360005b83811015610eb7578082015181840152602081019050610e9c565b50505050905090810190601f168015610ee45780820380516001836020036101000a031916815260200191505b50838103825260088152602001807f616c6c20676f6f640000000000000000000000000000000000000000000000008152506020019550505050505060405180910390a380600701548160040154101515610f7757600181600a01819055508363ffffffff167fa98c11bc69afe22b520fe800f82e421f9594d4f06259a7600711b75af05a43b960405160405180910390a25b600091505092915050565b600060018263ffffffff16815481101515610f9957fe5b90600052602060002090600b0201600801805490509050919050565b606060018363ffffffff16815481101515610fcc57fe5b90600052602060002090600b020160080182815481101515610fea57fe5b906000526020600020018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156110885780601f1061105d57610100808354040283529160200191611088565b820191906000526020600020905b81548152906001019060200180831161106b57829003601f168201915b5050505050905092915050565b60008385848151811015156110a657fe5b90602001906020020190600019169081600019168152505082806001019350506110cf82611916565b85848151811015156110dd57fe5b9060200190602002019060001916908160001916815250508280600101935050829050949350505050565b600060608060018463ffffffff1681548110151561112257fe5b90600052602060002090600b02019250604080519080825280601f01601f1916602001820160405280156111655781602001602082028038833980820191505090505b50915060016040519080825280602002602001820160405280156111985781602001602082028038833980820191505090505b5090507f72616e64282900000000000000000000000000000000000000000000000000008160008151811015156111cb57fe5b9060200190602002019060001916908160001916815250508363ffffffff167fb37f76c8ba24e6a6d20d203681329001f2cacd9ab37c09d8b2aee57b8a31b8746001604051808215151515815260200191505060405180910390a250505050565b5050565b60008060018054905090506001805480919060010161124f9190611a3f565b503360018263ffffffff1681548110151561126657fe5b90600052602060002090600b020160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508460018263ffffffff168154811015156112cb57fe5b90600052602060002090600b02016001018160001916905550600060018263ffffffff168154811015156112fb57fe5b90600052602060002090600b020160030181905550600060018263ffffffff1681548110151561132757fe5b90600052602060002090600b0201600401819055504260018263ffffffff1681548110151561135257fe5b90600052602060002090600b0201600501819055508360018263ffffffff1681548110151561137d57fe5b90600052602060002090600b0201600601819055508260018263ffffffff168154811015156113a857fe5b90600052602060002090600b020160070181905550826040519080825280602002602001820160405280156113f157816020015b60608152602001906001900390816113dc5790505b5060018263ffffffff1681548110151561140757fe5b90600052602060002090600b0201600801908051906020019061142b929190611a71565b508260405190808252806020026020018201604052801561145b5781602001602082028038833980820191505090505b5060018263ffffffff1681548110151561147157fe5b90600052602060002090600b02016009019080519060200190611495929190611ad1565b50600060018263ffffffff168154811015156114ad57fe5b90600052602060002090600b0201600a01819055508063ffffffff163373ffffffffffffffffffffffffffffffffffffffff167f8c2ac5e09d37c38a96fb20791b6ed6f2ccaaaf26c4115680b9257504d32bcdc34288888860016040518086815260200185600019166000191681526020018481526020018381526020018215151515815260200180602001828103825260088152602001807f616c6c20676f6f64000000000000000000000000000000000000000000000000815250602001965050505050505060405180910390a360009150509392505050565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60008060008060008060008060008060008060018d63ffffffff168154811015156115d557fe5b90600052602060002090600b020160010154955060018d63ffffffff168154811015156115fe57fe5b90600052602060002090600b020160070154945060018d63ffffffff1681548110151561162757fe5b90600052602060002090600b020160060154935060018d63ffffffff1681548110151561165057fe5b90600052602060002090600b020160040154925060018d63ffffffff1681548110151561167957fe5b90600052602060002090600b020160030154915060018d63ffffffff168154811015156116a257fe5b90600052602060002090600b02016009018054905090508585858585859b509b509b509b509b509b5050505050505091939550919395565b600060606000806000865192505b600083111561185d5782600187016040518082815260200191505060405180910390206001900481151561171857fe5b069150866001840381518110151561172c57fe5b9060200190602002015173ffffffffffffffffffffffffffffffffffffffff16878381518110151561175a57fe5b9060200190602002015173ffffffffffffffffffffffffffffffffffffffff1614151561184f57866001840381518110151561179257fe5b90602001906020020151905086828151811015156117ac57fe5b9060200190602002015187600185038151811015156117c757fe5b9060200190602002019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff168152505080878381518110151561181257fe5b9060200190602002019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff16815250505b8280600190039350506116e8565b87878163ffffffff16915094509450505050935093915050565b60008084868581518110151561188957fe5b9060200190602002019060001916908160001916815250508380600101945050600090505b825181101561190a5782818151811015156118c557fe5b9060200190602002015186858151811015156118dd57fe5b906020019060200201906000191690816000191681525050838060010194505080806001019150506118ae565b83915050949350505050565b600080821415611948577f300000000000000000000000000000000000000000000000000000000000000090506119b7565b5b60008211156119b657610100816001900481151561196357fe5b0460010290507f01000000000000000000000000000000000000000000000000000000000000006030600a8481151561199857fe5b06010260010281179050600a828115156119ae57fe5b049150611949565b5b809050919050565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10611a0057805160ff1916838001178555611a2e565b82800160010185558215611a2e579182015b82811115611a2d578251825591602001919060010190611a12565b5b509050611a3b9190611b5b565b5090565b815481835581811115611a6c57600b0281600b028360005260206000209182019101611a6b9190611b80565b5b505050565b828054828255906000526020600020908101928215611ac0579160200282015b82811115611abf578251829080519060200190611aaf929190611c1e565b5091602001919060010190611a91565b5b509050611acd9190611c9e565b5090565b828054828255906000526020600020908101928215611b4a579160200282015b82811115611b495782518260006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555091602001919060010190611af1565b5b509050611b579190611cca565b5090565b611b7d91905b80821115611b79576000816000905550600101611b61565b5090565b90565b611c1b91905b80821115611c1757600080820160006101000a81549073ffffffffffffffffffffffffffffffffffffffff0219169055600182016000905560038201600090556004820160009055600582016000905560068201600090556007820160009055600882016000611bf69190611d0d565b600982016000611c069190611d2e565b600a82016000905550600b01611b86565b5090565b90565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10611c5f57805160ff1916838001178555611c8d565b82800160010185558215611c8d579182015b82811115611c8c578251825591602001919060010190611c71565b5b509050611c9a9190611b5b565b5090565b611cc791905b80821115611cc35760008181611cba9190611d4f565b50600101611ca4565b5090565b90565b611d0a91905b80821115611d0657600081816101000a81549073ffffffffffffffffffffffffffffffffffffffff021916905550600101611cd0565b5090565b90565b5080546000825590600052602060002090810190611d2b9190611c9e565b50565b5080546000825590600052602060002090810190611d4c9190611b5b565b50565b50805460018160011615610100020316600290046000825580601f10611d755750611d94565b601f016020900490600052602060002090810190611d939190611b5b565b5b505600a165627a7a7230582015e1ffcde24bd26665fce5d7ea291f46d78d6cb87bc9fcf054851313b919bbef0029"
    callable_args = "f9011832f90114b88831336431326537323439323462626230383930366434333239633063663138343062663239373562306339313963656238643530653830333463383066303437663261303438623264323034666363643664333061346439396137653239386166386235303837326639663039633464303030313032303330343035303630373038303930613062b88836313837326637623464323162386533613935333835343263633061663564303539663663303561306665653961656666383732396232313138383166333434663261393466623661373030383062336632333437646233376432653236316231616365336333313938636135656163303030313032303330343035303630373038303930613062"
    callable = "mixAddresses(uint32,address[],uint)"
    callback = "distribute(uint,address[])"
    preprocessor = "rand"
    core_socket.connect()
    sig, result = core_socket.exec_evm(
        bytecode=bytecode,
        callable=callable,
        callable_args=callable_args,
        callback=callback,
        preprocessors=preprocessor
    )
    print("Sig: ", sig)
    print("Result: ", result)


@pytest.mark.skip(reason="Core needs to be alive for this")
def test_register():
    core_socket.connect()
    results_json = core_socket.get_report()
    pubkey = results_json['pub_key']
    quote = results_json['quote']
    print(results_json)
    print("quote: ", quote)
    print("pubkey: ", pubkey)
    assert len(bytes.fromhex(pubkey)) == 64


# @pytest.mark.skip(reason="Core needs to be alive for this")
# def test_exec_evm():
#     bytecode = "6080604052600436106100ae5763ffffffff7c010000000000000000000000000000000000000000000000000000000060003504166303988f8481146100b357806310f11e84146101165780632aaf281b146102095780633b8332451461028457806357f5fc28146102b4578063850d86191461034a578063a06a58561461035d578063b24fd5c51461037b578063d10e1e69146103ac578063daefe7381461040c578063dd20866e1461045d575b600080fd5b3480156100bf57600080fd5b506100cb60043561051a565b60408051600160a060020a0390991689526020890197909752878701959095526060870193909352608086019190915260a085015260c084015260e083015251908190036101000190f35b34801561012257600080fd5b5061012b610578565b60405180806020018060200180602001848103845287818151815260200191508051906020019060200280838360005b8381101561017357818101518382015260200161015b565b50505050905001848103835286818151815260200191508051906020019060200280838360005b838110156101b257818101518382015260200161019a565b50505050905001848103825285818151815260200191508051906020019060200280838360005b838110156101f15781810151838201526020016101d9565b50505050905001965050505050505060405180910390f35b60408051602060046024803582810135601f810185900485028601850190965285855261026095833563ffffffff1695369560449491939091019190819084018382808284375094975061070e9650505050505050565b6040518082600181111561027057fe5b60ff16815260200191505060405180910390f35b34801561029057600080fd5b506102a263ffffffff60043516610ac2565b60408051918252519081900360200190f35b3480156102c057600080fd5b506102d563ffffffff60043516602435610af3565b6040805160208082528351818301528351919283929083019185019080838360005b8381101561030f5781810151838201526020016102f7565b50505050905090810190601f16801561033c5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b61035b63ffffffff60043516610bc3565b005b34801561036957600080fd5b50610260600435602435604435610cae565b34801561038757600080fd5b50610390610faf565b60408051600160a060020a039092168252519081900360200190f35b3480156103b857600080fd5b5060408051602060046024803582810135848102808701860190975280865261026096843563ffffffff1696369660449591949091019291829185019084908082843750949750610fbe9650505050505050565b34801561041857600080fd5b5061042a63ffffffff60043516611233565b604080519687526020870195909552858501939093526060850191909152608084015260a0830152519081900360c00190f35b34801561046957600080fd5b506040805160206004602480358281013584810280870186019097528086526104bf96843563ffffffff169636966044959194909101929182918501908490808284375094975050933594506113519350505050565b6040518083815260200180602001828103825283818151815260200191508051906020019060200280838360005b838110156105055781810151838201526020016104ed565b50505050905001935050505060405180910390f35b600180548290811061052857fe5b60009182526020909120600b909102018054600182015460038301546004840154600585015460068601546007870154600a90970154600160a060020a0390961697509395929491939092909188565b60608060608060608060006001805490506040519080825280602002602001820160405280156105b2578160200160208202803883390190505b5060015460408051828152602080840282010190915291955080156105e1578160200160208202803883390190505b506001546040805182815260208084028201019091529194508015610610578160200160208202803883390190505b509150600090505b60015481101561070157600180548290811061063057fe5b90600052602060002090600b0201600a0154848281518110151561065057fe5b6020908102909101015260018054600091908390811061066c57fe5b600091825260208083203384526002600b90930201919091019052604090205411156106ad57600183828151811015156106a257fe5b602090810290910101525b60018054339190839081106106be57fe5b60009182526020909120600b9091020154600160a060020a031614156106f957600182828151811015156106ee57fe5b602090810290910101525b600101610618565b5091959094509092509050565b600080348110610768576040805160e560020a62461bcd02815260206004820152601f60248201527f4465706f7369742076616c7565206d75737420626520706f7369746976652e00604482015290519081900360640190fd5b6001805463ffffffff861690811061077c57fe5b90600052602060002090600b0201600a015460001415156107e7576040805160e560020a62461bcd02815260206004820152601b60248201527f496c6c6567616c20737461746520666f72206465706f736974732e0000000000604482015290519081900360640190fd5b6001805463ffffffff86169081106107fb57fe5b90600052602060002090600b0201905080600601543481151561081a57fe5b0615610896576040805160e560020a62461bcd02815260206004820152602f60248201527f4465706f7369742076616c7565206d7573742062652061206d756c7469706c6560448201527f206f6620636c61696d2076616c75650000000000000000000000000000000000606482015290519081900360840190fd5b33600090815260028201602052604090205415610923576040805160e560020a62461bcd02815260206004820152602a60248201527f43616e6e6f74206465706f73697420747769636520776974682074686520736160448201527f6d65206164647265737300000000000000000000000000000000000000000000606482015290519081900360840190fd5b600381018054349081019091553360009081526002830160205260409020556004810154600882018054859290811061095857fe5b906000526020600020019080519060200190610975929190611477565b506004810180546001908101909155604080513460208083018290529282018490526080808352875190830152865163ffffffff89169433947fce7036acc3606aaa1ec3a2e7b4d13b3f4da34ee1eac298fc47524074de74a3bf948a949390918291606083019160a08401919088019080838360005b83811015610a035781810151838201526020016109eb565b50505050905090810190601f168015610a305780820380516001836020036101000a031916815260200191505b50928303905250600881527f616c6c20676f6f6400000000000000000000000000000000000000000000000060208201526040805191829003019350915050a36007810154600482015410610ab8576001600a82015560405163ffffffff8516907fa98c11bc69afe22b520fe800f82e421f9594d4f06259a7600711b75af05a43b990600090a25b5060009392505050565b600060018263ffffffff16815481101515610ad957fe5b600091825260209091206008600b90920201015492915050565b606060018363ffffffff16815481101515610b0a57fe5b90600052602060002090600b020160080182815481101515610b2857fe5b600091825260209182902001805460408051601f6002600019610100600187161502019094169390930492830185900485028101850190915281815292830182828015610bb65780601f10610b8b57610100808354040283529160200191610bb6565b820191906000526020600020905b815481529060010190602001808311610b9957829003601f168201915b5050505050905092915050565b600060608060018463ffffffff16815481101515610bdd57fe5b6000918252602090912060408051818152606081018252600b909302909101945081602001602082028038833950506040805160018082528183019092529294509050602080830190803883390190505090507f72616e6428290000000000000000000000000000000000000000000000000000816000815181101515610c6057fe5b60209081029091018101919091526040805160018152905163ffffffff8716927fb37f76c8ba24e6a6d20d203681329001f2cacd9ab37c09d8b2aee57b8a31b874928290030190a250505050565b600180546000918190610cc3908281016114f5565b503360018263ffffffff16815481101515610cda57fe5b90600052602060002090600b020160000160006101000a815481600160a060020a030219169083600160a060020a031602179055508460018263ffffffff16815481101515610d2557fe5b90600052602060002090600b02016001018160001916905550600060018263ffffffff16815481101515610d5557fe5b90600052602060002090600b020160030181905550600060018263ffffffff16815481101515610d8157fe5b90600052602060002090600b0201600401819055504260018263ffffffff16815481101515610dac57fe5b90600052602060002090600b0201600501819055508360018263ffffffff16815481101515610dd757fe5b90600052602060002090600b0201600601819055508260018263ffffffff16815481101515610e0257fe5b90600052602060002090600b02016007018190555082604051908082528060200260200182016040528015610e4b57816020015b6060815260200190600190039081610e365790505b506001805463ffffffff8416908110610e6057fe5b90600052602060002090600b02016008019080519060200190610e84929190611526565b5082604051908082528060200260200182016040528015610eaf578160200160208202803883390190505b506001805463ffffffff8416908110610ec457fe5b90600052602060002090600b02016009019080519060200190610ee892919061157f565b50600060018263ffffffff16815481101515610f0057fe5b6000918252602091829020600a600b90920201019190915560408051428152918201879052818101869052606082018590526001608083015260c060a083018190526008908301527f616c6c20676f6f6400000000000000000000000000000000000000000000000060e08301525163ffffffff83169133917f8c2ac5e09d37c38a96fb20791b6ed6f2ccaaaf26c4115680b9257504d32bcdc3918190036101000190a3506000949350505050565b600054600160a060020a031681565b60008060018463ffffffff16815481101515610fd657fe5b90600052602060002090600b0201600a01546001141515611041576040805160e560020a62461bcd02815260206004820152601560248201527f4465616c206973206e6f742065786563757465642e0000000000000000000000604482015290519081900360640190fd5b8260018563ffffffff1681548110151561105757fe5b90600052602060002090600b0201600901908051906020019061107b92919061157f565b50600090505b6001805463ffffffff861690811061109557fe5b90600052602060002090600b02016009018054905081101561115a576001805463ffffffff86169081106110c557fe5b90600052602060002090600b0201600901818154811015156110e357fe5b60009182526020909120015460018054600160a060020a03909216916108fc919063ffffffff881690811061111457fe5b90600052602060002090600b0201600601549081150290604051600060405180830381858888f19350505050158015611151573d6000803e3d6000fd5b50600101611081565b6001805463ffffffff8616917f61347ea145bc2f7f5814e4a2b5e70991c5c42870bfd4df70ab8ea10c41cfa89d918390811061119257fe5b90600052602060002090600b02016006015460018763ffffffff168154811015156111b957fe5b60009182526020918290206009600b9092020101546040805193845263ffffffff909116918301919091526001828201526080606083018190526008908301527f616c6c20676f6f6400000000000000000000000000000000000000000000000060a0830152519081900360c00190a25060009392505050565b60008060008060008060008060008060008060018d63ffffffff1681548110151561125a57fe5b90600052602060002090600b020160010154955060018d63ffffffff1681548110151561128357fe5b90600052602060002090600b020160070154945060018d63ffffffff168154811015156112ac57fe5b90600052602060002090600b020160060154935060018d63ffffffff168154811015156112d557fe5b90600052602060002090600b020160040154925060018d63ffffffff168154811015156112fe57fe5b90600052602060002090600b020160030154915060018d63ffffffff1681548110151561132757fe5b600091825260209091206009600b909202010154959d949c50929a50909850965091945092505050565b815160009060609082805b600083111561146357604080516001880181529051908190036020019020839081151561138557fe5b069150866001840381518110151561139957fe5b90602001906020020151600160a060020a031687838151811015156113ba57fe5b60209081029091010151600160a060020a0316146114575786600184038151811015156113e357fe5b90602001906020020151905086828151811015156113fd57fe5b90602001906020020151876001850381518110151561141857fe5b600160a060020a039092166020928302909101909101528651819088908490811061143f57fe5b600160a060020a039092166020928302909101909101525b6000199092019161135c565b50505063ffffffff94909416949293505050565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106114b857805160ff19168380011785556114e5565b828001600101855582156114e5579182015b828111156114e55782518255916020019190600101906114ca565b506114f19291506115ed565b5090565b81548183558181111561152157600b0281600b028360005260206000209182019101611521919061160a565b505050565b828054828255906000526020600020908101928215611573579160200282015b828111156115735782518051611563918491602090910190611477565b5091602001919060010190611546565b506114f192915061168a565b8280548282559060005260206000209081019282156115e1579160200282015b828111156115e1578251825473ffffffffffffffffffffffffffffffffffffffff1916600160a060020a0390911617825560209092019160019091019061159f565b506114f19291506116ad565b61160791905b808211156114f157600081556001016115f3565b90565b61160791905b808211156114f157805473ffffffffffffffffffffffffffffffffffffffff19168155600060018201819055600382018190556004820181905560058201819055600682018190556007820181905561166c60088301826116de565b61167a6009830160006116ff565b506000600a820155600b01611610565b61160791905b808211156114f15760006116a4828261171d565b50600101611690565b61160791905b808211156114f157805473ffffffffffffffffffffffffffffffffffffffff191681556001016116b3565b50805460008255906000526020600020908101906116fc919061168a565b50565b50805460008255906000526020600020908101906116fc91906115ed565b50805460018160011615610100020316600290046000825580601f1061174357506116fc565b601f0160209004906000526020600020908101906116fc91906115ed5600a165627a7a7230582051910926ea55049d447d261d007a8b619986a8d7905958f802cb0688c27259bd0029"
#     callable_args = "f9015c80f90158b8aa3031646436386239366330613337303466303036653431393432356163613962636464633537303465333539356332393735303031343733336266373536653936366465626335393561343466613666383361343065363232393263316262616636313061373933356538613034623333373064363437323837333764636132346463653866323064393935323339643836616630333463636633323631663937623831333762393732b8aa3031646436386239366330613337303466303036653431393432356163613962636464633537303465333539356332393735303031343733336266373536653936366465626335393561343466613666383361343065363232393263316262616636313061373933356538613034623333373064363437323837333764636132346463653866323064393935323339643836616630333463636633323631663937623831333762393732"
#     callable = "mixAddresses(uint,address[],uint)"
#     callback = "distribute(uint32,address[])"
#     preprocessor = ['rand()'.encode()]
# >>>>>>> 7fa9ce701dd694d7cc23b6446a79612c314f58af
#     core_socket.connect()
#     sig, result = core_socket.exec_evm(
#         bytecode=bytecode,
#         callable=callable,
#         callable_args=callable_args,
#         callback=callback,
#         preprocessors=preprocessor
#     )
#     print("Sig: ", sig)
#     print("Result: ", result)
